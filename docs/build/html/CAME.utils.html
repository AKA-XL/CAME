

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>CAME.utils package &mdash; CAME  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="CAME.model package" href="CAME.model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CAME
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="CAME.html">CAME package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="CAME.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="CAME.datapair.html">CAME.datapair package</a></li>
<li class="toctree-l3"><a class="reference internal" href="CAME.model.html">CAME.model package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CAME.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.analyze">CAME.utils.analyze module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.base">CAME.utils.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.downsample_counts">CAME.utils.downsample_counts module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.evaluation">CAME.utils.evaluation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.plot">CAME.utils.plot module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.plot_pub">CAME.utils.plot_pub module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.preprocess">CAME.utils.preprocess module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils.train">CAME.utils.train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-CAME.utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CAME.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="CAME.html#module-CAME.PARAMETERS">CAME.PARAMETERS module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CAME.html#module-CAME.pipeline">CAME.pipeline module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CAME.html#module-CAME.pipeline_supervised">CAME.pipeline_supervised module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CAME.html#module-CAME">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CAME</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="CAME.html">CAME package</a> &raquo;</li>
        
      <li>CAME.utils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/CAME.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="came-utils-package">
<h1>CAME.utils package<a class="headerlink" href="#came-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-CAME.utils.analyze">
<span id="came-utils-analyze-module"></span><h2>CAME.utils.analyze module<a class="headerlink" href="#module-CAME.utils.analyze" title="Permalink to this headline">¶</a></h2>
<p>Created on Tue Nov  3 13:14:05 2020</p>
<p>&#64;author: Xingyan Liu</p>
<hr class="docutils" />
<p>Functions for downstream biological analysis</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.abstract_nodes">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">abstract_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_ord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'size'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'identity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'original</span> <span class="pre">name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.abstract_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Taking each of the groups in <cite>labels</cite> as an abstracted node, and making a
list of node attributes for further input to <cite>networkx.Graph.add_nodes_from()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_identity</strong> (<em>key name for the unique identifier for each abstracted node.</em>) – </p></li>
<li><p><strong>key_orig</strong> (<em>key name for the original</em><em> (</em><em>group</em><em>) </em><em>name for each abstracted node.</em>) – </p></li>
<li><p><strong>**kwds</strong> (<em>ignored currently</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_nodes</span> <span class="o">=</span> <span class="n">abstract_nodes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;module&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">node_attrs</span><span class="p">,</span> <span class="s1">&#39;node name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.abstract_ov_edges">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">abstract_ov_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'__temp_labels__'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_adjust</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_full_adj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.abstract_ov_edges" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_expr</strong> (<em>pd.DataFrame; each column represent the average expressoions</em>) – for each observation group, and each row as a variable.</p></li>
<li><p><strong>norm_method</strong> (<em>one of {None</em><em>, </em><em>'zs'</em><em>, </em><em>'maxmin'</em><em>, </em><em>'max'}</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.abstract_vv_edges">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">abstract_vv_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">df_links:</span> <span class="pre">pandas.core.frame.DataFrame,</span> <span class="pre">var_labels1:</span> <span class="pre">Union[pandas.core.series.Series,</span> <span class="pre">Mapping],</span> <span class="pre">var_labels2:</span> <span class="pre">Union[pandas.core.series.Series,</span> <span class="pre">Mapping],</span> <span class="pre">norm_sizes:</span> <span class="pre">Union[None,</span> <span class="pre">Sequence,</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">'auto',</span> <span class="pre">return_full_adj=True,</span> <span class="pre">global_adjust:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">global_norm_func=&lt;built-in</span> <span class="pre">function</span> <span class="pre">max&gt;,</span> <span class="pre">key_weight:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'weight',</span> <span class="pre">keys_link:</span> <span class="pre">Optional[Sequence[str]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">tag_var1:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'',</span> <span class="pre">tag_var2:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.abstract_vv_edges" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_links</strong> (pd.DataFrame, shape=(n_edges, <a href="#id1"><span class="problematic" id="id2">*</span></a>)) – If <cite>keys_edge</cite> is provided, it should be a tuple of 2 column-names
in df_links.columns, indicating the edge columns.
Otherwise, the <cite>df_links.index</cite> should be <cite>pd.MultiIndex</cite> to indicate
the source and target edges.
This can also be output form ResultsAnalyzer.weight_linked_vars(),
or the stored attribute <cite>ResultsAnalyzer.var_link_weights</cite></p></li>
<li><p><strong>keys_edge</strong> (If <cite>keys_edge</cite> is provided, it should be a tuple of 2 column-names) – in df_links.columns, indicating the edge columns.</p></li>
<li><p><strong>var_labels1</strong> – grouping labels for the two sets of variables, respectively.</p></li>
<li><p><strong>var_labels2</strong> – grouping labels for the two sets of variables, respectively.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.adata_neighbors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">adata_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.adata_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.adata_subgroup_edges">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">adata_subgroup_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'module'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.adata_subgroup_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>take a subset of the KNN-graph from adata, melt to an edge-dataframe, with
columns [‘source’, ‘target’, ‘weight’] by default.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.adj_to_edges">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">adj_to_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rownames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'source'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.adj_to_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Melt (Un-pivot) a pd.DataFrame of adjacent matrix into a list of edges, works
similar to <cite>pd.melt()</cite> but ignoring ALL of the zeros instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.aggregate_links">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">aggregate_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">df_links:</span> <span class="pre">pandas.core.frame.DataFrame,</span> <span class="pre">labels1:</span> <span class="pre">Union[pandas.core.series.Series,</span> <span class="pre">Mapping],</span> <span class="pre">labels2:</span> <span class="pre">Union[pandas.core.series.Series,</span> <span class="pre">Mapping],</span> <span class="pre">norm_sizes:</span> <span class="pre">Union[None,</span> <span class="pre">Sequence,</span> <span class="pre">str]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">global_adjust:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">global_norm_func=&lt;built-in</span> <span class="pre">function</span> <span class="pre">max&gt;,</span> <span class="pre">key_weight:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'weight',</span> <span class="pre">keys_link:</span> <span class="pre">Optional[Sequence[str]]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.aggregate_links" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_links</strong> (pd.DataFrame, shape=(n_edges, <a href="#id3"><span class="problematic" id="id4">*</span></a>)) – If <cite>keys_edge</cite> is provided, it should be a tuple of 2 column-names
in df_links.columns, indicating the edge columns.
Otherwise, the <cite>df_links.index</cite> should be <cite>pd.MultiIndex</cite> to indicate
the source and target edges.
This can also be output form ResultsAnalyzer.weight_linked_vars(),
or the stored attribute <cite>ResultsAnalyzer.var_link_weights</cite></p></li>
<li><p><strong>labels1</strong> – grouping labels for the rows and columns, respectively.</p></li>
<li><p><strong>labels2</strong> – grouping labels for the rows and columns, respectively.</p></li>
<li><p><strong>norm_sizes</strong> – if provided, should be a pair of pd.Series, dict, Mapping, list
it can be also set as ‘auto’, which means decide sizes by the group-labels.</p></li>
<li><p><strong>keys_link</strong> (<em>str</em><em> (</em><em>'weight' by default</em><em>)</em>) – If <cite>keys_edge</cite> is provided, it should be a tuple of 2 column-names
in df_links.columns, indicating the edge columns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.arrange_contingency_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">arrange_contingency_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">novel_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['unknown',</span> <span class="pre">'uncertain',</span> <span class="pre">'multi-type']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.arrange_contingency_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>alignment of column and row names</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.compute_group_eigens">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">compute_group_eigens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.compute_group_eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>compute eigen-vector for each group
groups:</p>
<blockquote>
<div><p>if provided, compute only for these groups, with the order kept.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.edges_from_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">edges_from_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'source'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.edges_from_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>transform the connectivities in <cite>adata</cite> into an edge-dataframe, with
columns [‘source’, ‘target’, ‘weight’] by default.</p>
<p>kind: ‘conn’, ‘dist’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.export_neighbor_subgraph_df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">export_neighbor_subgraph_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('.')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tfset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.export_neighbor_subgraph_df" title="Permalink to this definition">¶</a></dt>
<dd><p>temp function;</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.export_subgraph_df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">export_subgraph_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('.')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tfset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.export_subgraph_df" title="Permalink to this definition">¶</a></dt>
<dd><p>export graph to ‘.csv’ files for other visualization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.get_adata_neighbors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">get_adata_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.get_adata_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>getting distances and connectivities from adata</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.jointly_extract_modules">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">jointly_extract_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leiden'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cluster'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.jointly_extract_modules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.load_dpair_and_model">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">load_dpair_and_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdir_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'_models'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.load_dpair_and_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.make_abstracted_graph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">make_abstracted_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_labels1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_labels2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_labels1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_labels2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_expr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_expr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_var_links</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_group_order1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_group_order2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('',</span> <span class="pre">'')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('',</span> <span class="pre">'')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'size'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'identity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_ov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.55</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_mtd_ov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_adjust_ov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_adjust_vv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vargroup_filtered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filtered'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.make_abstracted_graph" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_labels1</strong> – </p></li>
<li><p><strong>obs_labels2</strong> – </p></li>
</ul>
</dd>
</dl>
<p>:param :
:param var_labels1:
:param var_labels2:
:param :
:param avg_expr1:
:param avg_expr2:
:param :
:param df_var_links:
:param :
:param norm_mtd_ov:
:type norm_mtd_ov: one of {None, ‘zs’, ‘maxmin’, ‘max’}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.make_nx_input_from_df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">make_nx_input_from_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.make_nx_input_from_df" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame with each column containing node attributes</em>) – </p></li>
<li><p><strong>key_id</strong> – which column(s) should be used for unique identifier for each nodes.
str or list of strings from df.columns, or None (using <cite>df.index</cite> in this case)
If specified, the values should be unique.</p></li>
<li><p><strong>**attrs</strong> – other common attributes for this batch of nodes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A list of tuples, with each tuple formed like <cite>(node, attrdict)</cite> when</p></li>
<li><p><cite>len(key_id) == 1</cite> or <cite>(u, v, attrdict)</cite> when <cite>len(key_id) == 2</cite></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">node_attrs</span> <span class="o">=</span> <span class="n">make_nx_input_from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">node_attrs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.module_scores">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">module_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'module'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.module_scores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.neighbor_induced_edgedf">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">neighbor_induced_edgedf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['source',</span> <span class="pre">'target']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.neighbor_induced_edgedf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.neighbor_induced_subgraph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">neighbor_induced_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">networkx.classes.graph.Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.neighbor_induced_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Note that the returned graph also contains the edges connecting the
neighbor-nodes if there is any.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.nx_from_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">nx_from_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">networkx.classes.graph.Graph</span></span></span><a class="headerlink" href="#CAME.utils.analyze.nx_from_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>nx.Graph from the KNN graph of <cite>adata</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.nx_multipartite_graph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">nx_multipartite_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">node_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'subset'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.nx_multipartite_graph" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">nx_multipartite_graph</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">multipartite_layout</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">subset_key</span><span class="o">=</span><span class="n">subset_key</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.nx_neighbors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">nx_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.nx_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>find all the neighbors of given nodes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.nx_to_dfs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">nx_to_dfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">networkx.classes.graph.Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodelist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'source'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.nx_to_dfs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>edgedf, nodedf</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">edgedf</span><span class="p">,</span> <span class="n">nodedf</span> <span class="o">=</span> <span class="n">nx_to_dfs</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.nx_to_nodedf">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">nx_to_nodedf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodelist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.nx_to_nodedf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.order_by_similarities">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">order_by_similarities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.order_by_similarities" title="Permalink to this definition">¶</a></dt>
<dd><p>sims: pd.DataFrame with the same index and columns</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.paired_data_neighbors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">paired_data_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks_inner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binarize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'adjusted'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">anndata._core.anndata.AnnData</span></span></span><a class="headerlink" href="#CAME.utils.analyze.paired_data_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>X1, X2: np.ndarray, shape = (n_obs1, n_var) and (n_obs2, n_var)
adata: if provided, should contain (n_obs1 + n_obs2) data observations, and</p>
<blockquote>
<div><p>each columns should be matched with <cite>X1</cite> followed by <cite>X2</cite>!!!</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.set_adata_obsm">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">set_adata_obsm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.set_adata_obsm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>key_add: which key will be added to adata.obsm</dt><dd><p>probably be ‘X_umap’, ‘X_h’, ‘X_pca’, etc.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_adata_obsm</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">h_cell</span><span class="p">,</span> <span class="s1">&#39;X_h&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">use_rep</span><span class="o">=</span><span class="s1">&#39;X_h&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.set_precomputed_neighbors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">set_precomputed_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.set_precomputed_neighbors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.weight_linked_vars">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">weight_linked_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">scipy.sparse.base.spmatrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_dist2weight</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.weight_linked_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>correlations (consine distances) of each linked (homologous) pairs
of variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – np.ndarray;
feature matrix of shape (N, M), where N is the number of sample and M is
the feature dimensionality.</p></li>
<li><p><strong>adj</strong> – sparse.spmatrix; binary adjacent matrix of shape (N, N).</p></li>
<li><p><strong>names</strong> – a sequence of names;
names for rows of <cite>X</cite>, of shape (N,)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(name1, name2), distance, weight</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame with columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.weight_normalize_by_size">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">weight_normalize_by_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">adj</span></em>, <em class="sig-param"><span class="pre">sizes1</span></em>, <em class="sig-param"><span class="pre">sizes2</span></em>, <em class="sig-param"><span class="pre">norm_func=&lt;built-in</span> <span class="pre">function</span> <span class="pre">max&gt;</span></em>, <em class="sig-param"><span class="pre">global_adjust=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.weight_normalize_by_size" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adj</strong> (<em>pd.DataFrame</em>) – adjacent matrix of shape (n1, n2)</p></li>
<li><p><strong>sizes1</strong> (<em>pd.Series</em><em>, </em><em>dict</em><em>, </em><em>Mapping</em><em>, </em><em>list-like</em>) – shape = (n1,) and (n2,)</p></li>
<li><p><strong>sizes2</strong> (<em>pd.Series</em><em>, </em><em>dict</em><em>, </em><em>Mapping</em><em>, </em><em>list-like</em>) – shape = (n1,) and (n2,)</p></li>
<li><p><strong>global_adjust</strong> (<em>bool</em>) – whether to perform a global adjustment after
size-normalization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.wrapper_confus_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">wrapper_confus_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'true'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.wrapper_confus_mat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>normalize: ‘true’, ‘pred’, ‘all’, None</dt><dd><p>by default, normalized by row (true classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.wrapper_contingency_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">wrapper_contingency_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.wrapper_contingency_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified and wrapped function from <cite>sklearn</cite>:
&gt;&gt;&gt; mat = sklearn.metrics.cluster.contingency_matrix(
…        y_true, y_pred, eps=eps, sparse=assparse)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.analyze.write_graph_cyjs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.analyze.</span></span><span class="sig-name descname"><span class="pre">write_graph_cyjs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp.ctjs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.analyze.write_graph_cyjs" title="Permalink to this definition">¶</a></dt>
<dd><p>Cytoscape Json format</p>
</dd></dl>

</div>
<div class="section" id="module-CAME.utils.base">
<span id="came-utils-base-module"></span><h2>CAME.utils.base module<a class="headerlink" href="#module-CAME.utils.base" title="Permalink to this headline">¶</a></h2>
<p>Created on Sat Feb 20 12:16:32 2021</p>
<p>&#64;author: Xingyan Liu</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.check_dirs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">check_dirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.check_dirs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.dec_timewrapper">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">dec_timewrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'function'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.dec_timewrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.load_json_dict">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">load_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.load_json_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.load_pickle">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">load_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.load_pickle" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">load_pickle</span><span class="p">(</span><span class="s1">&#39;results.pickle&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.make_nowtime_tag">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">make_nowtime_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nowtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brackets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.make_nowtime_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.make_pairs_from_lists">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">make_pairs_from_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lst2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_equal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.make_pairs_from_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>making combinational pairs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.save_json_dict">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">save_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test_json.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.save_json_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.save_pickle">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">save_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.save_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.strline">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">strline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.strline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.subsample_each_group">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">subsample_each_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.subsample_each_group" title="Permalink to this definition">¶</a></dt>
<dd><p>randomly sample indices from each group, labeled by <cite>group_labels</cite>.
and return the sampled indices.</p>
<p>n_out: number of samples for each group</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.subsample_single">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">subsample_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.subsample_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>N:</dt><dd><p>The total number of the original indices to be subsampled</p>
</dd>
<dt>frac:</dt><dd><p>Subsample to this <cite>fraction</cite> of the number of indices.</p>
</dd>
<dt>n_min:</dt><dd><p>If the resulting number of indices is less than <cite>n_min</cite>, then
<cite>min([n_min, N])</cite> indices will be sampled, where <cite>N</cite> is
the total number of the original indices.</p>
</dd>
<dt>n_out:</dt><dd><p>if specified, it must be smaller than N, and the two arguments
<cite>frac</cite> and <cite>n_min</cite> will be ignored.</p>
</dd>
<dt>seed:</dt><dd><p>random state</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.base.write_info">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.base.</span></span><span class="sig-name descname"><span class="pre">write_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">dicts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.base.write_info" title="Permalink to this definition">¶</a></dt>
<dd><p>key words parameter-dicts</p>
</dd></dl>

</div>
<div class="section" id="module-CAME.utils.downsample_counts">
<span id="came-utils-downsample-counts-module"></span><h2>CAME.utils.downsample_counts module<a class="headerlink" href="#module-CAME.utils.downsample_counts" title="Permalink to this headline">¶</a></h2>
<p>&#64;author: Xingyan Liu
&#64;file: vis_hidden_layers.py
&#64;time: Dec 23 22:06:09 2020</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.downsample_counts.downsample_counts">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.downsample_counts.</span></span><span class="sig-name descname"><span class="pre">downsample_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts_per_cell</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_counts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#CAME.utils.downsample_counts.downsample_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample counts from count matrix.</p>
<p>If <cite>counts_per_cell</cite> is specified, each cell will downsampled.
If <cite>total_counts</cite> is specified, expression matrix will be downsampled to
contain at most <cite>total_counts</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – Annotated data matrix.</p></li>
<li><p><strong>counts_per_cell</strong> – Target total counts per cell. If a cell has more than ‘counts_per_cell’,
it will be downsampled to this number. Resulting counts can be specified
on a per cell basis by passing an array.Should be an integer or integer
ndarray with same length as number of obs.</p></li>
<li><p><strong>total_counts</strong> – Target total counts. If the count matrix has more than <cite>total_counts</cite>
it will be downsampled to have this number.</p></li>
<li><p><strong>random_state</strong> – Random seed for subsampling.</p></li>
<li><p><strong>replace</strong> – Whether to sample the counts with replacement.</p></li>
<li><p><strong>copy</strong> – Determines whether a copy of <cite>adata</cite> is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Depending on <cite>copy</cite> returns or updates an <cite>adata</cite> with downsampled <cite>.X</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.downsample_counts.downsample_counts_per_cell">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.downsample_counts.</span></span><span class="sig-name descname"><span class="pre">downsample_counts_per_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.downsample_counts.downsample_counts_per_cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.downsample_counts.downsample_total_counts">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.downsample_counts.</span></span><span class="sig-name descname"><span class="pre">downsample_total_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.downsample_counts.downsample_total_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CAME.utils.evaluation">
<span id="came-utils-evaluation-module"></span><h2>CAME.utils.evaluation module<a class="headerlink" href="#module-CAME.utils.evaluation" title="Permalink to this headline">¶</a></h2>
<p>Created on Sun Apr 11 19:43:10 2021</p>
<p>&#64;author: Xingyan Liu</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.evaluation.accuracy">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.evaluation.accuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.evaluation.get_AMI">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">get_AMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.evaluation.get_AMI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.evaluation.get_F1_score">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">get_F1_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.evaluation.get_F1_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CAME.utils.plot">
<span id="came-utils-plot-module"></span><h2>CAME.utils.plot module<a class="headerlink" href="#module-CAME.utils.plot" title="Permalink to this headline">¶</a></h2>
<p>Created on Fri Oct 23 12:31:28 2020</p>
<p>&#64;author: Xingyan Liu</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.alluvial_plot">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">alluvial_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confsdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['',</span> <span class="pre">'']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'alluvial</span> <span class="pre">plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab20_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fonsize_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.alluvial_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>visualizing confusion matrix using alluvial plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.diy_cmap_grey_bg">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">diy_cmap_grey_bg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_fg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdPu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.diy_cmap_grey_bg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.get_colors">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">get_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">'Reds'</span></em>, <em class="sig-param"><span class="pre">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.get_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>fx.view_color_map(‘Reds’, 4)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.grid_display_probas">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">grid_display_probas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.grid_display_probas" title="Permalink to this definition">¶</a></dt>
<dd><p>violin plots of the distributions</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.heatmap">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_hmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'shrink':</span> <span class="pre">0.5}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yrotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>norm_method: None, ‘zs’, ‘max’, ‘maxmin’
norm_axis: 0 or 1. 0 for column-normalization and 1 for rows.
figsize: tuple, (6, 6) by default, ignored if ax is not None.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.heatmap_probas">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">heatmap_probas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_heat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_lb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab20'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.heatmap_probas" title="Permalink to this definition">¶</a></dt>
<dd><p>heatmap showing probabilities</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.multipartite_layout">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">multipartite_layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'subset'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vertical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spread_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.multipartite_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Position nodes in layers of straight lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>NetworkX graph</em><em> or </em><em>list of nodes</em>) – A position will be assigned to every node in G.</p></li>
<li><p><strong>subset_key</strong> (<em>string</em><em> (</em><em>default='subset'</em><em>)</em>) – Key of node data to be used as layer subset.</p></li>
<li><p><strong>align</strong> (<em>string</em><em> (</em><em>default='vertical'</em><em>)</em>) – The alignment of nodes. Vertical or horizontal.</p></li>
<li><p><strong>scale</strong> (<em>number</em><em> (</em><em>default: 1</em><em>)</em>) – Scale factor for positions.</p></li>
<li><p><strong>center</strong> (<em>array-like</em><em> or </em><em>None</em>) – Coordinate pair around which to center the layout.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pos</strong> – A dictionary of positions keyed by node.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">complete_multipartite_graph</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">multipartite_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This algorithm currently only works in two dimensions and does not
try to minimize edge crossings.</p>
<p>Network does not need to be a complete multipartite graph. As long as nodes
have subset_key data, they will be placed in the corresponding layers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_confus_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_confus_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'true'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(4,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_confus_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>by default, normalized by row (true classes)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_confus_multi_mats">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_confus_multi_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_confus_multi_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>combime multiple confusion matrix-plots into a single plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_contingency_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_contingency_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_rows</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_cols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(4,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_contingency_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_distance_lines">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_distance_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_distance_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>names: a list of str, yticklabels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_edges_by_adj">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_edges_by_adj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds_edge</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_edges_by_adj" title="Permalink to this definition">¶</a></dt>
<dd><p>adj: a sparse matrix, None is allowed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_line_list">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_line_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4.5,</span> <span class="pre">3.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.05,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_line_list" title="Permalink to this definition">¶</a></dt>
<dd><p>ys: a list of lists, each sub-list is a set of curve-points to be plotted.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_mapped_graph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_mapped_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab20'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds_edge</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_mapped_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>pt_color1, pt_color2: RGB colors or numerical label sequence</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_multipartite_graph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_multipartite_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'subset'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'weight'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodelb_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'original</span> <span class="pre">name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodesz_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'size'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lightblue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_size_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_size_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_multipartite_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_records_for_trainer">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_records_for_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'training</span> <span class="pre">logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_records_for_trainer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.plot_splitted_umaps">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">plot_splitted_umaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.plot_splitted_umaps" title="Permalink to this definition">¶</a></dt>
<dd><p>multiple-plots of embeddings</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.rescale_layout">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">rescale_layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.rescale_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns scaled position array to (-scale, scale) in all axes.</p>
<p>The function acts on NumPy arrays which hold position information.
Each position is one row of the array. The dimension of the space
equals the number of columns. Each coordinate in one column.</p>
<p>To rescale, the mean (center) is subtracted from each axis separately.
Then all values are scaled so that the largest magnitude value
from all axes equals <cite>scale</cite> (thus, the aspect ratio is preserved).
The resulting NumPy Array is returned (order of rows unchanged).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>numpy array</em>) – positions to be scaled. Each row is a position.</p></li>
<li><p><strong>scale</strong> (<em>number</em><em> (</em><em>default: 1</em><em>)</em>) – The size of the resulting extent in all directions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pos</strong> – scaled positions. Each row is a position.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_layout_dict</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.rotate_xticklabels">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">rotate_xticklabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.rotate_xticklabels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.rotate_yticklabels">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">rotate_yticklabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.rotate_yticklabels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.triple_umaps">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">triple_umaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['dataset',</span> <span class="pre">'is_private',</span> <span class="pre">'is_private']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">4.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.triple_umaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Specific function for gene embeddings only, to be generized</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.umap_grid">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">umap_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adatas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.umap_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>multiple-plots of embeddings</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.umap_with_annotates">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">umap_with_annotates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anno_df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anno_fontsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plkwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.umap_with_annotates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.venn_plot">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">venn_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Venn</span> <span class="pre">plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.venn_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>sets: iterable
set_labels: list[str]
regular: bool, only for sets of strings!</p>
<blockquote>
<div><p>wether to regularize the strings in sets</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.view_color_map">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">view_color_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.view_color_map" title="Permalink to this definition">¶</a></dt>
<dd><p>n: total number of colors
k: number of colors to be plotted on each line.</p>
<p class="rubric">Examples</p>
<p>import funx as fx
colors = [‘Set1’, ‘viridis’, ‘Spectral’]
fx.view_color_map(colors[-1], n=20)</p>
<p>cmap = sc.pl.palettes.zeileis_26
cmap = sc.pl.palettes.default_64
fx.view_color_map(cmap, k=16)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot.wrapper_heatmap_scores">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot.</span></span><span class="sig-name descname"><span class="pre">wrapper_heatmap_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_score</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_label</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'celltype'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_pred</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'predicted'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(5,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_subsample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot.wrapper_heatmap_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>sort columns and rows, plot heatmap of celltype scores</p>
</dd></dl>

</div>
<div class="section" id="module-CAME.utils.plot_pub">
<span id="came-utils-plot-pub-module"></span><h2>CAME.utils.plot_pub module<a class="headerlink" href="#module-CAME.utils.plot_pub" title="Permalink to this headline">¶</a></h2>
<p>Created on Wed May  5 11:51:20 2021</p>
<p>&#64;author: Xingyan Liu</p>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.plot_pub.plot_pure_umap">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.plot_pub.</span></span><span class="sig-name descname"><span class="pre">plot_pure_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('.')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svg'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.plot_pub.plot_pure_umap" title="Permalink to this definition">¶</a></dt>
<dd><p>plot for publication</p>
</dd></dl>

</div>
<div class="section" id="module-CAME.utils.preprocess">
<span id="came-utils-preprocess-module"></span><h2>CAME.utils.preprocess module<a class="headerlink" href="#module-CAME.utils.preprocess" title="Permalink to this headline">¶</a></h2>
<p>Created on Thu Aug  6 00:21:15 2020
&#64;author: Xingyan Liu</p>
<hr class="docutils" />
<blockquote>
<div><p>Functions for handling AnnData;</p>
<ul class="simple">
<li><p>I/O functions</p></li>
<li><dl class="simple">
<dt>preprocessing</dt><dd><ul>
<li><p>normalization / z-scoring / …</p></li>
<li><p>groups / …</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>statistics computation</p></li>
</ul>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.adata_from_raw">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">adata_from_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_npz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_mtx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.adata_from_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>read matrix and annotated names from directory <cite>dirname</cite></p>
<dl>
<dt><a href="#id5"><span class="problematic" id="id6">|</span></a>-dirname</dt><dd><p><a href="#id7"><span class="problematic" id="id8">|</span></a>-matrix.npz
<a href="#id9"><span class="problematic" id="id10">|</span></a>-genes.tsv
<a href="#id11"><span class="problematic" id="id12">|</span></a>-barcodes.tsv (or meta_cell.tsv)</p>
</dd>
<dt>Alternative (for load mtx file):</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_10x_mtx</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.add_columns">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">add_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwannos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.add_columns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.add_new_edgetype_to_dglgraph">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">add_new_edgetype_to_dglgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_edge_tgt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">scipy.sparse.base.spmatrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.add_new_edgetype_to_dglgraph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.add_obs_annos">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">add_obs_annos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.add_obs_annos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.add_var_annos">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">add_var_annos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.add_var_annos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.agg_group_edges">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">agg_group_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.agg_group_edges" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>adj:</dt><dd><p>adjacent matrix of shape (N0, N1), if <cite>labels2</cite> is None, then set N0=N1.</p>
</dd>
<dt>labels1:</dt><dd><p>a list or a np.array of shape (N0,)</p>
</dd>
<dt>labels2:</dt><dd><p>a list or a np.array of shape (N1,)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>group_conn</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>summation of connected edges between given groups</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.align_adata_vars">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">align_adata_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.align_adata_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>adata1: reference data
adata2: query data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.all_vars_of_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">all_vars_of_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.all_vars_of_adata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.bisplit_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">bisplit_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_groups</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_index_by</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#CAME.utils.preprocess.bisplit_adata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.change_names">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">change_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">gnames</span></em>, <em class="sig-param"><span class="pre">foo_change=&lt;function</span> <span class="pre">regu_gname&gt;</span></em>, <em class="sig-param"><span class="pre">**kw</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.change_names" title="Permalink to this definition">¶</a></dt>
<dd><p>foo_change: function to map a name-string to a new one
<a href="#id13"><span class="problematic" id="id14">**</span></a>kw: other kwargs for foo_change</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.compute_and_get_DEGs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">compute_and_get_DEGs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rank_genes_groups'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t-test'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.compute_and_get_DEGs" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, assume that the counts in adata has been normalized.
If <cite>force_redo</cite>: re-compute DEGs and the original DEGs in adata will be ignored</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.compute_unkn_rate">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">compute_unkn_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gcnt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.compute_unkn_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>unknown rate computing</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.compute_unkn_rate_for2">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">compute_unkn_rate_for2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gcnt1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcnt2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.compute_unkn_rate_for2" title="Permalink to this definition">¶</a></dt>
<dd><p>unknown rate computing</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.describe_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">describe_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.describe_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.describe_mat_nnz">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">describe_mat_nnz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.describe_mat_nnz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.dict_has_keys">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">dict_has_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.dict_has_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>return True if all the keys are in the dict, else False.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.filter_mitogenes">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">filter_mitogenes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.filter_mitogenes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.get_homologues">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_homologues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_match</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniquelist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_null</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.get_homologues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.get_hvgs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_hvgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hvg_kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.get_hvgs" title="Permalink to this definition">¶</a></dt>
<dd><p>if <cite>force_redo</cite> is True, data should be normalized and log-transformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – The annotated data matrix of shape <cite>n_obs</cite> × <cite>n_vars</cite>. Rows correspond
to cells and columns to genes.</p></li>
<li><p><strong>min_mean</strong> – </p></li>
<li><p><strong>max_mean</strong> – </p></li>
<li><p><strong>min_disp</strong> – </p></li>
<li><p><strong>max_disp</strong> – </p></li>
<li><p><strong>n_top_genes</strong> – Number of highly-variable genes to keep.
If specified, other parameters will be ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.get_marker_info_table">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_marker_info_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rank_genes_groups'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.get_marker_info_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.get_marker_name_table">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_marker_name_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rank_genes_groups'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.get_marker_name_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.get_scnet">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_scnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.get_scnet" title="Permalink to this definition">¶</a></dt>
<dd><p>If the adata has not been preprocessed, please run
<cite>adata_processed = quick_preprocess(adata, **kwds)</cite> first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_mean">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>This function may work with more efficiency than <cite>df.groupby().mean()</cite>
when handling sparse matrix. (obviously~)
—
X: shape (n_samples, n_features)
labels: shape (n_samples, )
classes: optional, names of groups
features: optional, names of features</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_mean_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_mean_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_mean_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>groupby: a column name in adata.obs
features: a subset of names in adata.var_names (or adata.raw.var_names)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a pd.DataFrame with features as index and groups as columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_mean_dense">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_mean_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'group'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_mean_dense" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_mean_multiadata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_mean_multiadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adatas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_mean_multiadata" title="Permalink to this definition">¶</a></dt>
<dd><p>tags: tag of each adata to avoid column-name collision</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_median_dense">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_median_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'group'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_median_dense" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_value_counts">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_value_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_value_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>extended function of pd.value_counts
count_on: str; which column to apply function <cite>pd.value_counts</cite>
group_by: str; which column to group-by
split: bool; split the Series and concatenate them as columns if True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_zscore">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_zscore" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>X: np.array, shape (n_samples, n_features)</dt><dd><p>i.e. each row of X is an observation, wile each column is a feature</p>
</dd>
<dt>with_mean: boolean, True by default</dt><dd><p>If True, center the data before scaling, and X shoud be a dense matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.group_zscore_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">group_zscore_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'counts'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cover</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.group_zscore_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>adt: AnnData
key: str in [‘X_pca’, ‘count’]</p>
<blockquote>
<div><p>can be a key from adt.obsm, e.g. <cite>key=’X_pca’</cite>
If key == ‘counts’, then do scaling on <cite>adt.X</cite>
and cover the old count matrix, ignoring the <cite>cover</cite> parameter</p>
</div></blockquote>
<dl class="simple">
<dt>groupby: str;</dt><dd><p>A key from adt.obs, from which the labels are take</p>
</dd>
<dt>cover: bool</dt><dd><p>whether to cover the old X with the scored X</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.homograph_from_scipy">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">homograph_from_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dgl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.homograph_from_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>making a homolohous DGL graph from a scipy.sparse matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.is1v1pairs">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">is1v1pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.is1v1pairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.is_symetric">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">is_symetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.is_symetric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.label_binarize_each">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">label_binarize_each</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.label_binarize_each" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.load_dense">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">load_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.load_dense" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.load_namelist">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">load_namelist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.load_namelist" title="Permalink to this definition">¶</a></dt>
<dd><p>icol:
only return the first column by default</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.load_sparse">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">load_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_npz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.load_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>fpath</cite> should be ended with ‘.mtx’ or ‘npz’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.make_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">make_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.make_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>An alternative way to construct AnnData (BUG fixed).
Something might go wrong when saving the AnnData object constructed
by the build-in function <cite>sc.AnnData</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.make_bipartite_adj">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">make_bipartite_adj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_singleton</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.make_bipartite_adj" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>df_map: pd.DataFrame with 2 columns.</dt><dd><p>each row represent an edge between 2 nodes from the left and right
group of nodes of the bipartite-graph.</p>
</dd>
<dt>nodes1, nodes2: list-like;</dt><dd><p>node name-list representing left and right nodes, respectively.</p>
</dd>
<dt>key_data: str or None;</dt><dd><p>if provided, should be a name in df.columns, where the values will be
taken as the weights of the adjacent matrix.</p>
</dd>
<dt>with_singleton: whether allow nodes without any neighbors. (default: True)</dt><dd><p>if nodes1 and nodes2 are not provided, this parameter makes no difference.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.make_dict_from_str">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">make_dict_from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#CAME.utils.preprocess.make_dict_from_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.make_id_name_maps">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">make_id_name_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.make_id_name_maps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>concatenate 2 list of names, and return 2 kinds of maps:</dt><dd><ol class="arabic simple">
<li><p>integer id –&gt; name</p></li>
<li><p>name –&gt; integer id (a tuple of 2 dicts)</p></li>
</ol>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>using 2 dict to map a name to its id for that
– the 2 name-lists may share the same name!
(while the indices are unique)</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.mean_of_nozeros">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">mean_of_nozeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.mean_of_nozeros" title="Permalink to this definition">¶</a></dt>
<dd><p>mat: np.arrary or scipy.sparse. matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.merge_adata_groups">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">merge_adata_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_lists</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.merge_adata_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>merge the given groups into one single group
which is named as ‘_’.join(groups[i]) by default
<cite>group_lists</cite>: a list of lists of group names</p>
<p>=== TEST ===
&gt;&gt;&gt; merge_adata_groups(adata, ‘batch’, [list(‘AB’), list(‘EF’)], copy=True)
&gt;&gt;&gt; merge_adata_groups(adata, ‘batch’, [list(‘AB’), list(‘EF’)],)
&gt;&gt;&gt; adata</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.merge_adatas">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">merge_adatas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adatas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_dsname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.merge_adatas" title="Permalink to this definition">¶</a></dt>
<dd><p>(a new adata will be created, use the raw matrix)</p>
<dl class="simple">
<dt>adatas: a list or a dict of AnnData objects.</dt><dd><p>use data from adata.raw if not None.</p>
</dd>
</dl>
<p>union: whether to take union of the features (e.g. genes)
obs_keys: column-names from sample annotations to be merged
dsnames: names for these datasets, if None, use numbers ranging from</p>
<blockquote>
<div><p>0 to (n_datasets-1)</p>
</div></blockquote>
<p>key_dsname: if provided as a str, a column will be added to the merged <cite>obs</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.merge_group_labels">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">merge_group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_lists</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.merge_group_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>labels: list-like
group_lists: a list of lists of group names to be merged</p>
<p>=== TEST ===
&gt;&gt;&gt; merge_group_labels(adata.obs[‘batch’], [list(‘AB’), list(‘EF’)]).unique()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.merge_metas">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">merge_metas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adatas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.merge_metas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.merge_named_matrices">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">merge_named_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.merge_named_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>This function code is copied from <cite>scanorama.merge_datasets</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_list</strong> – a list of cell-by-gene matrices (np.ndarray or sparse.csr_matrix)</p></li>
<li><p><strong>gene_lists</strong> – a list of gene-list corresponding to the columns of each matrix in
<cite>mat_list</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mat_list</em> – a list of cell-by-gene matrices (sparse.csr_matrix) with aligned gene
columns.</p></li>
<li><p><em>ret_genes</em> – a gene list shared by all the mat_list</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.mtx2df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">mtx2df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.mtx2df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_col">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_col" title="Permalink to this definition">¶</a></dt>
<dd><p>make the column elements of X to unit sum
scale_factor: numeric, None</p>
<blockquote>
<div><p>if None: use the median of sum level as the scaling factor.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_default">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_default_rev0">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_default_rev0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_default_rev0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_max">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_maxmin">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_maxmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_maxmin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_norms">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_norms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_norms" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper of <cite>normalize_colsum</cite> and <cite>normalize_rowsum</cite>
axis = 0: apply to each column;
axis = 1: apply to each row.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.normalize_row">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalize_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.normalize_row" title="Permalink to this definition">¶</a></dt>
<dd><p>make the row elements of X to unit sum
scale_factor: numeric, None</p>
<blockquote>
<div><p>if None: use the median of sum level as the scaling factor.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.order_contingency_mat">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">order_contingency_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.order_contingency_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.pivot_df_to_sparse">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">pivot_df_to_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.pivot_df_to_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>row, col: str or int, int for column index, and str for column name</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.pivot_to_sparse">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">pivot_to_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rownames</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colnames</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.pivot_to_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>rows</cite> and <cite>cols</cite> hould be of the same length!
rownames:</p>
<blockquote>
<div><p>If provided, the resulting matrix rows are restricted to <cite>rownames</cite>,
Names will be removed if they are not in <cite>rownames</cite>, and names that
not occur in <cite>rows</cite> but in <cite>rownames</cite> will take ALL-zeros in that row
of the resulting matrix.
if not provided, will be set as <cite>rows.unique()</cite></p>
</div></blockquote>
<dl class="simple">
<dt>colnames:</dt><dd><p>if not provided, will be set as <cite>cols.unique()</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.quick_pre_clust">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">quick_pre_clust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hvgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nneigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hvg_kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.quick_pre_clust" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.quick_pre_vis">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">quick_pre_vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hvgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nneigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hvg_kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.quick_pre_vis" title="Permalink to this definition">¶</a></dt>
<dd><p>go through the default pipeline and have a overall visualization of
the data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.quick_preprocess">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">quick_preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hvgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nneigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hvg_kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.quick_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>if <cite>normalize_data</cite> is True, an adata with RAW counts is requered!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.regu_gname">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">regu_gname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'^X[0-9]{2,3}'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.regu_gname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.remove_adata_groups">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">remove_adata_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.remove_adata_groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.remove_adata_small_groups">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">remove_adata_small_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.remove_adata_small_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>return adata with small groups removed, grouped by <cite>key</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.remove_small_groups">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">remove_small_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.remove_small_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>return labels with small groups removed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.reverse_dict">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">reverse_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span></span></span><a class="headerlink" href="#CAME.utils.preprocess.reverse_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>the values of the dict must be un-changable type</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.reverse_dict_of_list">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">reverse_dict_of_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span></span></span><a class="headerlink" href="#CAME.utils.preprocess.reverse_dict_of_list" title="Permalink to this definition">¶</a></dt>
<dd><p>the values of the dict must be list-like type</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.save_mtx2df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">save_mtx2df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.save_mtx2df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.save_named_mtx">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">save_named_mtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_npz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.save_named_mtx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.save_namelist">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">save_namelist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.save_namelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.scipy_edge_dict_for_dgl">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">scipy_edge_dict_for_dgl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.scipy_edge_dict_for_dgl" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>foo: a callable object.</dt><dd><p>For example, <cite>torch.LongTensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.split_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">split_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">anndata._core.anndata.AnnData</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#CAME.utils.preprocess.split_adata" title="Permalink to this definition">¶</a></dt>
<dd><p>key: a column-name of <cite>adata.obs</cite>
output: dict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.subset_matches">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">subset_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_match</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.subset_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>(take a subset of homo-gene matches)</p>
<p>df_match: pd.DataFrame with at least 2 columns
left: list-like, for subsetting elements in the first column.
right: list-like, for subsetting elements in the second column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.take_1v1_matches">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">take_1v1_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.take_1v1_matches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.take_adata_groups">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">take_adata_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onlyx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.take_adata_groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.take_freq1">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">take_freq1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.take_freq1" title="Permalink to this definition">¶</a></dt>
<dd><p>take elements that occur only once in <cite>lst</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.take_freq1more">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">take_freq1more</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.take_freq1more" title="Permalink to this definition">¶</a></dt>
<dd><p>take elements that occur more than once in <cite>lst</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.take_group_labels">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">take_group_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.take_group_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>labels: list-like
group_names: names of groups that you want to take out
col: str, column name in df.columns
indicate: bool;</p>
<blockquote>
<div><p>if True, return a Series of bool indicators of the groups
else, return the labels.</p>
</div></blockquote>
<dl class="simple">
<dt>remove: bool; False by defaut.</dt><dd><p>True if you want to keep groups that NOT in the <cite>given group_names</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.top_markers_from_adata">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">top_markers_from_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">anndata._core.anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rank_genes_groups'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.top_markers_from_adata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.top_markers_from_df">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">top_markers_from_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.top_markers_from_df" title="Permalink to this definition">¶</a></dt>
<dd><p>marker_df: a data-frame with cluster names as columns, and genes as values
groups: a list of cluster names (column names)
return a flattened marker list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.unpack_dict_of_lists">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">unpack_dict_of_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.unpack_dict_of_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.wrapper_normalize">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">wrapper_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxmin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.wrapper_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.wrapper_scale">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">wrapper_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.wrapper_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function for centering and scaling data matrix <cite>X</cite> in sc.AnnData,
extended for within-batch cprocessing.</p>
<p class="rubric">Example</p>
<p>wrapper_scale(adata, groupby=’batch’)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.preprocess.zscore">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.preprocess.</span></span><span class="sig-name descname"><span class="pre">zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.preprocess.zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>code borrowed from <cite>scanpy.pp._simple</cite></p>
</dd></dl>

</div>
<div class="section" id="module-CAME.utils.train">
<span id="came-utils-train-module"></span><h2>CAME.utils.train module<a class="headerlink" href="#module-CAME.utils.train" title="Permalink to this headline">¶</a></h2>
<p>Created on Sun Apr 11 19:15:45 2021</p>
<p>&#64;author: Xingyan Liu</p>
<dl class="py class">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">BaseTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_dict</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_main</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">PosixPath('.')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DO NOT use it directly!</p>
<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.all_to_device">
<span class="sig-name descname"><span class="pre">all_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.all_to_device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.get_current_outputs">
<span class="sig-name descname"><span class="pre">get_current_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">other_inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.get_current_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the current states of the model output</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.load_model_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.make_train_logs">
<span class="sig-name descname"><span class="pre">make_train_logs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.make_train_logs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.save_checkpoint_record">
<span class="sig-name descname"><span class="pre">save_checkpoint_record</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.save_checkpoint_record" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.save_model_weights">
<span class="sig-name descname"><span class="pre">save_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.save_model_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>better NOT set the path <cite>fp</cite> manually~</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.save_whole_model">
<span class="sig-name descname"><span class="pre">save_whole_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model.pt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.save_whole_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.set_dir">
<span class="sig-name descname"><span class="pre">set_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_main</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('.')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.set_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.set_inputs">
<span class="sig-name descname"><span class="pre">set_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_dict</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.set_inputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.set_recorder">
<span class="sig-name descname"><span class="pre">set_recorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.set_recorder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.set_train_params">
<span class="sig-name descname"><span class="pre">set_train_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.set_train_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>setting parameters for:</dt><dd><p>lr: learning rate
l2norm: <cite>weight_decay</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>abstract method to be re-defined</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.train_minibatch">
<span class="sig-name descname"><span class="pre">train_minibatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.train_minibatch" title="Permalink to this definition">¶</a></dt>
<dd><p>abstract method to be re-defined</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.BaseTrainer.write_train_logs">
<span class="sig-name descname"><span class="pre">write_train_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train_logs.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.BaseTrainer.write_train_logs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_dict</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dgl.heterograph.DGLHeteroGraph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_main</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('.')</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CAME.utils.train.BaseTrainer" title="CAME.utils.train.BaseTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">CAME.utils.train.BaseTrainer</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.get_current_outputs">
<span class="sig-name descname"><span class="pre">get_current_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">other_inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.get_current_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the current states of the model output</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.plot_class_accs">
<span class="sig-name descname"><span class="pre">plot_class_accs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.plot_class_accs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.plot_class_losses">
<span class="sig-name descname"><span class="pre">plot_class_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.plot_class_losses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.plot_cluster_index">
<span class="sig-name descname"><span class="pre">plot_cluster_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.plot_cluster_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.set_class_weights">
<span class="sig-name descname"><span class="pre">set_class_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">class_weights=None</span></em>, <em class="sig-param"><span class="pre">foo=&lt;ufunc</span> <span class="pre">'sqrt'&gt;</span></em>, <em class="sig-param"><span class="pre">n_add=0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.set_class_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">350</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_lossfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">43</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">other_inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Main function for model training</p>
</div></blockquote>
<p>other_inputs: other inputs for <cite>model.forward()</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CAME.utils.train.Trainer.train_minibatch">
<span class="sig-name descname"><span class="pre">train_minibatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_lossfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">other_inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.Trainer.train_minibatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Funtcion for minibatch trainging</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.train.get_checkpoint_list">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">get_checkpoint_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.get_checkpoint_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.train.make_class_weights">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">make_class_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">labels</span></em>, <em class="sig-param"><span class="pre">astensor=True</span></em>, <em class="sig-param"><span class="pre">foo=&lt;ufunc</span> <span class="pre">'sqrt'&gt;</span></em>, <em class="sig-param"><span class="pre">n_add=0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.make_class_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.train.prepare4train">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">prepare4train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpair</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="CAME.datapair.html#CAME.datapair.unaligned.DataPair" title="CAME.datapair.unaligned.DataPair"><span class="pre">CAME.datapair.unaligned.DataPair</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="CAME.datapair.html#CAME.datapair.aligned.AlignedDataPair" title="CAME.datapair.aligned.AlignedDataPair"><span class="pre">CAME.datapair.aligned.AlignedDataPair</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_clust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clust_lbs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_within</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">3,</span> <span class="pre">3.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#CAME.utils.train.prepare4train" title="Permalink to this definition">¶</a></dt>
<dd><p>dpair: DataPair
test_idx: if provided, should be an index-sequence of the same length as</p>
<blockquote>
<div><p><cite>cluster_labels</cite></p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CAME.utils.train.seed_everything">
<span class="sig-prename descclassname"><span class="pre">CAME.utils.train.</span></span><span class="sig-name descname"><span class="pre">seed_everything</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">123</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CAME.utils.train.seed_everything" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CAME.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-CAME.utils" title="Permalink to this headline">¶</a></h2>
<p>Created on Sun Dec 27 21:59:44 2020</p>
<p>&#64;author: Xingyan Liu</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="CAME.model.html" class="btn btn-neutral float-left" title="CAME.model package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Academy of Mathematics and Systems Science, CAS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>